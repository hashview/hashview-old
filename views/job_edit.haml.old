!!!
%html
  - @taskarray = Hash.new
  - @tasks.each do |task|
    - @taskarray[task.id] = task.name
  /https://jsfiddle.net/vigneshmoha/bbxMe/2/
  %body
    %p
    :javascript
      function showDiv() {
        var Index = document.jobs_form.customer.options[document.jobs_form.customer.selectedIndex].value
        if(Index == "add_new")
        {
          document.getElementById('new_customer_div').style.display = 'inline';
        }
        else
        {
          document.getElementById('new_customer_div').style.display = 'none';
        }
      }
    %script{:type => "text/javascript"}
      :plain
        function dateGenerate() {
        var date = new Date()
        var dateArray = #{@taskhashforjs};
        
        return dateArray;
        }
        // The Above function will create an array of five consecutive year from the the current year.
        function addSelect(divname) {
        var newDiv=document.createElement('div');
        var html = '<select name="tasks[]">', dates = dateGenerate(), i;
        for (var k in dates) {
          if (dates.hasOwnProperty(k)) {
            html += "<option value='"+k+"'>"+dates[k]+"</option>";
          }
        }
        html += '</select><p>';
        newDiv.innerHTML= html;
        document.getElementById(divname).appendChild(newDiv);
        }
    .span15 
      %br
      .container
        - if @jobtasks
          %h2 Edit Job
        - else
          %h2 Create a new Job
        %br
        .row
          .col-md-10
            - if @jobtasks
              %form{:class => "form-horizontal", :action => "/jobs/edit/#{@job.id}", :method => "post"}
                .form-group
                  %label.control-label.col-xs-2{:for => ""} Job Name
                  .col-xs-10
                    %input{:type => "textbox", :class => "form-control", :name => "name", :id => "name", :value => "#{@job.name}"}
                .form-group
                  %label.control-label.col-xs-2{:for => ""} Assigned Tasks
                  .col-xs-10
                    .table
                      %table{:class => 'table'}
                        - @jobtasks.each do |jt|
                          - @tasks.each do |task|
                            - if jt.task_id == task.id
                              %tr 
                                %td #{task.name}  
                                %td{:class => 'col-md-3'}
                                  .btn-group.btn-group-xs
                                    %a.btn.btn-warning{:href => "/jobs/#{@job.id}/task/delete/#{jt.id}"}
                                      %i.glyphicon.glyphicon-trash{:title => 'Delete'}
                      %p
                    .dropdown#dropdown
                    %button.btn.btn-default#add{:type => "button", :onclick => "addSelect('dropdown');"} Add Task
                .form-group
                  .col-xs-offset-2.col-xs-10
                    %button.btn.btn-primary{:type => "submit"} Save
            - else
              %form{:name => "jobs_form", :id => "jobs_form", :class => "form-horizontal", :action => "/jobs/create", :method => "post"}
                .form-group
                  %label.control-label.col-xs-2{:for => ""} Job Name
                  .col-xs-10
                    %input{:type => "textbox", :class => "form-control", :name => "name", :id => "name"}
                .form-group
                  %label.control-label.col-xs-2{:for => ""} Customer
                  .col-xs-10
                    %select.form-control{:id => "customer", :name => "customer", :onchange => "showDiv()"}
                      - @customers.each do |customer|
                        %option{:value => "#{customer.id}", :name => "cust_id", :type => "button"} #{customer.name}
                      %option{:value => "add_new", :name => "cust_id", :type => "button"} New Customer
                .section
                  %div{:class => "label_leftalign field"}
                    #new_customer_div{:style => "display:none"}
                      .form-group
                        %label.control-label.col-xs-2{:for => ""} Customer Name
                        .col-xs-10
                          %input{:type => "textbox", :class => "form-control", :name => "cust_name", :id => "name"}
                      .form-group
                        %label.control-label.col-xs-2{:for => ""} Customer Description
                        .col-xs-10
                          %input{:type => "textbox", :class => "form-control", :name => "cust_desc", :id => "desc"}

                - if !@hashfiles.empty?
                  .form-group
                    %label.control-label.col-xs-2{:for => ""} Hashfile
                    .col-xs-10
                      %select.form-control{:id => "hashfile", :name => "hashfile", :onchange => "showDiv()"}
                        - if @customers
                          - @customers.each do |customer|
                            - @hashfiles.each do |hashfile|
                              - if hashfile.customer_id == customer.id
                                %option{:value => "#{hashfile.id}", :name => "hf_id", :type => "button"} #{hashfile.name}
                        %option{:value => "add_new", :name => "hf_id", :type => "button"} New Hashfile
                  .form-group
                    %label.control-label.col-xs-2{:for => ""} Assigned Tasks
                    .col-xs-10
                      .dropdown#dropdown
                      %button.btn.btn-default#add{:type => "button", :onclick => "addSelect('dropdown');"} Add Task
                  .form-group
                    .col-xs-offset-2.col-xs-10
                      %button.btn.btn-primary{:type => "submit"} Create
                - else
                  .form-group
                    %label.control-label.col-xs-2{:for => ""} Hashfile Name
                    .col-xs-10
                      %input{:type => "textbox", :class => "form-control", :name => "hf_name", :id => "name"}
                  .form-group
                    %label.control-label.col-xs-2{:for => ""} Hashfile Upload 
                    .col-xs-10
                      %input{:type => 'file', :name => "hash_file"}
                  .form-group
                    .col-xs-offset-2.col-xs-10
                      %br
                      %button.btn.btn-primary{:type => 'submit', :href => "/customers/#{customer.id}//upload/hashfile"} Upload

                .section
                  %div{:class => "label_leftalign field"}
                    #new_hashlist_div{:style => "display:none"}
                      .form-group
                        %label.control-label.col-xs-2{:for => ""} Hashlist Name
                        .col-xs-10
                          %input{:type => "textbox", :class => "form-control", :name => "hl_name", :id => "name"}
                      .form-group
                        %label.control-label.col-xs-2{:for => ""} Customer Description
                        .col-xs-10
                          %input{:type => "textbox", :class => "form-control", :name => "cust_desc", :id => "desc"}
